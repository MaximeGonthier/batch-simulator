\documentclass[a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{color}
\usepackage[dvipsnames]{xcolor}
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{diagbox}
\usepackage{colortbl}
\usepackage{pdfpages}
\usepackage{todonotes}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{xspace}
\usepackage{xcolor,pifont}
\usepackage{fullpage}
\usepackage{algorithm, algpseudocode}
\usepackage[hidelinks]{hyperref}
\usepackage[english]{babel}
%~ \usepackage[backend=bibtex]{biblatex}
%~ \bibliography{ref_cadre}
\algnewcommand\algorithmicforeach{\textbf{for each}}
\algdef{S}[FOR]{ForEach}[1]{\algorithmicforeach\ #1\ \algorithmicdo}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}
\newtheorem{Problem}{Problem}
\newtheorem{Theorem}{Theorem}
\newtheorem{Lemma}{Lemma}
\newtheorem{Hypothesis}{Hypothesis}
\providecommand{\keywords}[1]{\textbf{\textit{Key-words:}} #1}
\newcommand{\LM}[1]{\textcolor{red}{LM:~{#1}}}
\newcommand{\ST}[1]{\textcolor{orange}{ST:~{#1}}}
\newcommand{\TODO}[1]{\textcolor{olive}{TODO:~{#1}}}
\newcommand{\Q}[1]{\textcolor{blue}{Q:~{#1}}}
\setlength{\parskip}{0.2 cm}
\title{Notes articles}
\author{Maxime GONTHIER Samuel THIBAULT Loris MARCHAL}

\newcommand{\card}[1]{\ensuremath{\left|{#1}\right|}\xspace}
\newcommand{\live}{\ensuremath{L}\xspace}
\newcommand{\evict}{\ensuremath{\mathcal{V}}\xspace}
\newcommand{\dataset}{\ensuremath{\mathbb{D}}\xspace}
\newcommand{\taskset}{\ensuremath{\mathbb{T}}\xspace}
\newcommand{\packageset}{\ensuremath{\mathbb{P}}\xspace}
\newcommand{\inputs}{\ensuremath{\mathcal{D}}\xspace}
\newcommand{\optpb}{\textsc{Min\-Loads\-For\-Tasks\-Sharing\-Data}\xspace}
\newcommand{\nbloads}{\ensuremath{\mathit{\mathit{\#Loads}}}\xspace}
\newcommand{\MIN}{\ensuremath{\mathit{MIN}}\xspace}
\newcommand{\starpu}{\textsc{StarPU}\xspace}
\newcommand{\nbPU}{\ensuremath{\vert PU \vert}\xspace}

\usepackage{tikz}
\usetikzlibrary{fit, shapes.geometric, patterns}

\makeatletter\tikzset{hatch distance/.store in=\hatchdistance,hatch distance=5pt,hatch thickness/.store in=\hatchthickness,hatch thickness=5pt}\pgfdeclarepatternformonly[\hatchdistance,\hatchthickness]{north east hatch}{\pgfqpoint{-1pt}{-1pt}}{\pgfqpoint{\hatchdistance}{\hatchdistance}}{\pgfpoint{\hatchdistance-1pt}{\hatchdistance-1pt}}{\pgfsetcolor{\tikz@pattern@color}\pgfsetlinewidth{\hatchthickness}\pgfpathmoveto{\pgfqpoint{0pt}{0pt}}\pgfpathlineto{\pgfqpoint{\hatchdistance}{\hatchdistance}}\pgfusepath{stroke}}\makeatother\usetikzlibrary{calc,shadings,patterns,tikzmark}\newcommand\HatchedCell[5][0pt]{\begin{tikzpicture}[overlay,remember picture]\path ($(pic cs:#2)!0.5!(pic cs:#3)$)coordinate(aux1)(pic cs:#4)coordinate(aux2);\fill[#5]($(aux1)+(-0.23*0.075\textwidth,1.9ex)$)rectangle($(aux1 |- aux2)+(0.23*0.075\textwidth,-#1*\baselineskip-.8ex)$);\end{tikzpicture}}

\newcounter{nodemarkers}
\newcommand\circletext[1]{%
    \tikz[overlay,remember picture] 
        \node (marker-\arabic{nodemarkers}-a) at (0,1.5ex) {};%
    #1%
    \tikz[overlay,remember picture]
        \node (marker-\arabic{nodemarkers}-b) at (0,0){};%
    \tikz[overlay,remember picture,inner sep=2pt]
        \node[draw,ellipse,fit=(marker-\arabic{nodemarkers}-a.center) (marker-\arabic{nodemarkers}-b.center)] {};%
    \stepcounter{nodemarkers}%
}

% Pour les checkmark
\newcommand*\colourcheck[1]{%
  \expandafter\newcommand\csname #1check\endcsname{\textcolor{#1}{\ding{52}}}
}
\colourcheck{green}
\newcommand{\ok}[1]{\textcolor{ForestGreen}{OK \greencheck}}
\newcommand{\oktext}[1]{\textcolor{ForestGreen}{OK \greencheck}~\textcolor{ForestGreen}{#1}}

\begin{document}

%~ \tableofcontents
\newpage

%~ /data-aware-batch-scheduling/MBSS$ oarsub -p orion -l core=2,walltime=08:00:00 -r '2022-06-14 19:00:00' "bash Stats_single_workload.sh inputs/workloads/converted/test-11 inputs/clusters/rackham_450_128_32_256_4_1024.txt Fcfs 0"

\section{Informations for the article}
	\begin{enumerate}
		\item HEFT is like fcfs with a score x1 x0 x0 x0
		\item Use same X scale for some gantt charts when I want to compare them: to do that add a job of duration 0 at the maxtime of the heuristic you are showing
		\item Faire plusieurs test et mettre une barre d'erreur (ce qui varie c'est la taille des fichiers d'entrées lors de la génération du workload). For this I did Generate\_workload\_from\_rackham\_for\_variance.sh to generate different workloads (10 is enough or I go up to 30 ? Might take a while if I do 30 times the same test. Or maybe just once to show the varaince is small ?) and then I try them all and show the variance.
		\item Use same X scale for workloads stats when I want to compare them
		\item cluster usage in real: https://www.uppmax.uu.se/resources/system-usage/rackham/
		\item About files in the simulation: %\url{https://webmail.ens-lyon.fr/?_task=mail&_caps=pdf%3D1%2Cflash%3D0%2Ctif%3D0&_uid=5368&_mbox=INBOX&_action=show}
	 \end{enumerate}

\section{What's new since last meeting ?}

	\begin{enumerate}
		% Pour elisabeth et carl
		\item Re-writing of area filling
		\item More heatmaps fcfs with a score and all multipliers combination heatmaps
		\item Code area filling ratio and area filling omniscient
		\item pseudo code area filling with different filling of allocated area (It's: Allocated Area[choosen size][x] gets Allocated Area[choosen size][x] + Area(Ji) with Area(Ji) = cores*walltime. But I would prefer to do: cores*(delay+transfer time))
		\item code area filling with ratio and allocated area
		\item code easybf fcfs only
		\item are filling omnisicnet comme je fais en ce moment. Si ca marche pas essayer avec le graduellement
		\item dans area filling: A la place de immedialy est ce que ca finir a plus tot sur le noeud de taille x + 1 et comparer aussi avec x + 2 ... x + n.
		\item Size constraint: sorting by size is bad if normal cluster
		\item ignore dt for constraint == 2
		\item revoir area filling tart dans le main en fct de planned or ratio et des nouveau noms de fichiers et retester avec les 2 cluster différents.
		\item plot with nb of upgraded jobs
		\item plot avec backfill. Ameliore fcfs mais fcfs score est meilleur sans. La diff e transfert est grande entre fcfs score et fcfs score bf
		\item Why are filling so bad ? Even in omniscient ? I corrected a bit but it's still worse. Also there is a difference between true allocated area and the one I compute in the schedule (because the scheduele change and I only update allocated area when a job start. Else I have a temp one just for the current schedule).
		\item Try in area filling to reduce allocated area by the diff between walltime and real delay if the job finished before it's walltime
		\item Comment one paper of vincenc
		\item Mail au gars de data locality sur numa: Jannis Klinkenberg
		\item dossier inscription administrative
		\item attestation sur siged de acaces et IPDPS
		\item plot the number of jobs where the queue time is superior to 25000 for example
		\item tirer quelques conclusions dans le document principal
		\item plot 2 contraintes ensembles
		\item code pour tracer terminaison des jobs -2 sur courbes usage du cluster: mais toujours pas full. Je devrais prendre bcp plus loin dans le futur ?
		\item tester en faisant varier le multiplicateur de fcfs score area filling: je n'observe pas d'améliorations
		\item Afficher temps de transferts sur les Gantt charts
		
		% Reu du 29/08
		\item Pour le workload: ignorer jobs cancelled. Ne pas ignorer job failed ou timeout. Si jobs multi node les diviser. Ajout d'un overhead de 2*1min aux jobs et de 1*2min aux failed. Data sur tous les jobs.
		\item stats sur workload can be plotted
		\item cluster usage is good now
		\item temporalité des gros jobs en terme de submit time
		\item looking at further jobs for workload but not adding them in my schedule if after day2 (14 jours entier et couper pour voir si on a vraiment tout)
		\item ré ecriture des algos fcfs score + backfill big nodes or + area filling
		\item new plots size constraint only
		\item code backfill 95th percentile: trop de complexité car je regarde tout les noeuds

		% Reu du 06/09
		\item mettre des long long pour fcfs with a score
		\item voir fonctionnement area filling ratio en détail: penser a update allocated area dans start et end jobs pour les nouveaux algo area filing
		\item Je prendres une semaine plus tôt pour recup les planned and ratio area en cas non omniscient
		\item Je prends 1 mois entier dans le passé pour ratio area
	\end{enumerate}
	
\section{Questions for next meeting}
	\begin{enumerate}
		\item
	\end{enumerate}
	
\section{Todo}
	\subsection{General}
		\begin{enumerate}
			\item se renseigner payement enseirb semestre 1: (demander a sandrine truffier ?)
			\item payer ré inscription attendre leurs mail
			\item Voir mission Dallas: demander a denis
			\item mail calendrier mes autres cours enseirbs: attendre réponse
			\item Répondre a Bora
			\item transmettre dossier siged  et payer une fois tous les avis saisies (5/6 ou 6/6)
			\item Check rendu rapports le 30 Aout pour les 3A dont je suis rapporteur
			\item Date redu rapport des 2A ?
		\end{enumerate}
	\subsection{Uppsala}
		\begin{enumerate}
			\item test size constraint area filling normal en regardant 14 jours dans le passé
			\item mettre des long long dans les int
			\item reduire complexité 95th percentile en s'arretant des qu'on est plus dans les 5\% et recommencersi on upgrade
			\item ecrire et coder area filling strat 2 mais diviser par planned area
			\item strat 3 backfill big nodes changer un peu: a la place de la proba voir les jobs suivants de taille x+1 (dans la liste connu) et les schedule pour de faux pour avoir la somme de leurs queue time. Puis faire de même avec au milieu notre job j, faire la différecne pour Loss.
			
			\item corriger histogrammes stats workloads
			\item ajouter backffill big node classique a 2 contrainte pour monrer que ca marche pas dans ce cas ?
			\item strat backfill big nodes: p*scoreperdu vs score sur x / 95 percentile des scores pour le job ? / score de cahque type puis ponderation et choix aleatoire /
			\item coder algos fcfs score + backfill big nodes or + area filling avec et sans ratio (attention pour les area filling faut mettre a jour dans start jobs et end jobs)
			\item coder les mêmes avec backfill
			\item les tester avec les 2 contraintes
			\item tester avec data sur jobs de plus de 5 cores seulement
			\item backfill big node avec fcfs score: faire a la place si dans taille + 1 je bats la moyenne des scores precedant de 50\% au moin je peux le compute dessus. + voir area filling aussi puis tester
			\item size constraint: montrer moyenne de cahque taille de job separemment pour stretch: codé, à plot
			\item varier les ratio de chaque taille voir si a un moment l'agressivité est detrimentale et varier proportions de tailles de jobss en mode pas de transferts de données
			\item regarder qui sont les jobs delaier de plus de 25000
			\item refaire tests 2 contraintes avec easybf sur tous
			\item test autres workloads pour les 2 contraintes
			\item voir pk ca crash avec bcp de jobs
			\item mettre a jour planned area pour fcfs score area filling quand j'upgrade des jobs ?
			\item generation de workload : aller chercher loin puis cut le fichier plus tôt pour pas avoir trop de jobs non plus ?
			\item Ne pas oublier que j'ai les courbes VS sur flow stretch et queue times aussi que je peux tracer						
			\item Rendre le code général (20 pour cores par node et 3 pour nb tailles de noeuds différents)
		\end{enumerate}
\end{document}
